# -*- coding: utf-8 -*-
from pykrx import stock
import time
from datetime import datetime
import multiprocessing
import numpy as np
import parmap
import telegram
import csv
import os


def Csv_init(data):
    data = [
        data[0][1],
        round(data[1][1], 2),
        round(data[2][1], 2),
        data[3][1],
        round(data[4][1], 5),
    ]
    print(data)
    with open(str(os.getcwd()) + "/savedata3.csv", "a", newline="") as file:
        writer = csv.writer(file)
        writer.writerow(data)
        # tickers = list(binance.fetch_tickers().keys())
        # writer.writerow(tickers)
        # writer.writerow([SignalMaker(tickers[x]) for x in range(24)])
        # writer.writerow([0 for i in range(24)])


def get_perfomance(trade_log):
    win = []
    lose = []
    risk_free = 0.038 / 365
    avg = np.mean(trade_log)
    std = np.std(trade_log)
    size = (avg - risk_free) / (std * std)

    for i in range(len(trade_log)):
        if trade_log[i] > 0:
            win.append(trade_log[i])
        elif trade_log[i] < 0:
            lose.append(trade_log[i])
    """
    print('총거래 : ', len(trade_log))
    print('수익거래수 :', len(win))
    print('손실거래수 :', len(lose))
    print('평균거래 :',avg)
    print('평균수익거래 :', np.mean(win))
    print('평균손실거래 :', np.mean(lose))
    print('평균손익비 :', -1 * np.mean(win) / np.mean(lose))
    print('승률 :', int(round(len(win) / len(trade_log),2) * 100), '%')
    print('포지션 사이징 :', size)
    print('')
    """
    result = []
    result.append(["총거래 : ", len(trade_log)])
    # result.append(['수익거래수 :', len(win)])
    # result.append(['손실거래수 :', len(lose)])
    result.append(["평균거래 :", avg])
    # result.append(['평균수익거래 :', np.mean(win)])
    # result.append(['평균손실거래 :', np.mean(lose)])
    result.append(["평균손익비 :", -1 * np.mean(win) / np.mean(lose)])
    if len(trade_log) == 0:
        win_rate = 0
    else:
        win_rate = int(round(len(win) / len(trade_log), 2) * 100)
    result.append(["승률 :", win_rate, "%"])
    result.append(["포지션 사이징 :", size])
    # telegram_send(result)
    # print(result)
    Csv_init(result)


def telegram_send(data):
    bot = telegram.Bot(token=my_token)
    if type(data) != "str":
        data = str(data)
    while 1:
        try:
            bot.send_message(chat_id=801167350, text=data)
            time.sleep(3)
            return None
        except:
            continue


def get_time(temp):
    now = temp
    YYYY = str(now.year)
    MM = str(now.month)
    DD = str(now.day)
    hh = str(now.hour)
    mm = str(now.minute)

    if len(MM) != 2:
        MM = "0" + MM
    if len(DD) != 2:
        DD = "0" + DD
    if len(hh) != 2:
        hh = "0" + hh
    if len(mm) != 2:
        mm = "0" + mm

    return YYYY + MM + DD, hh + mm


def log_maker(ticker, start_date, end_date):
    buy_sell_log = []
    # df = stock.get_market_ohlcv_by_date("20000101", Today, ticker)
    # df = stock.get_market_ohlcv_by_date("20200101", Today, ticker)
    # df = stock.get_market_ohlcv_by_date("20000201", "20000301", ticker)
    df = stock.get_market_ohlcv_by_date(start_date, end_date, ticker)

    EndPoint = len(df) - 1
    Slippage = 0.9971925603

    for i in range(3, EndPoint):

        # Y = yesterday
        ohlcv_ = df.iloc[i - 1]  # 당일 OHLCV
        Y_ohlcv = df.iloc[i - 2]  # 전일 OHLCV
        Y_high = Y_ohlcv["고가"]
        Y_close = Y_ohlcv["종가"]
        Y_low = Y_ohlcv["저가"]
        # PP = (Y_high + Y_low + (2 * Y_close)) / 4
        PP = (Y_high + Y_low + (Y_close)) / 3
        S2 = PP - Y_high + Y_low
        _low = ohlcv_["저가"]
        _close = ohlcv_["종가"]

        S1_5 = 1.88 * PP - Y_high

        if Y_high == 0 or Y_close == 0 or Y_low == 0 or _low == 0 or _close == 0:
            continue

        if _low <= S1_5:
            earning = 100 * ((_close / S1_5) * Slippage - 1)
            buy_sell_log.append(earning)

    return buy_sell_log


Today = get_time(datetime.now())[0]


def mainfunc(start_date, end_date):
    print("")
    print(start_date, end_date)
    num_cores = multiprocessing.cpu_count()
    konex = [
        "341310",
        "179530",
        "336040",
        "331660",
        "337840",
        "093510",
        "327970",
        "329050",
        "309900",
        "317860",
        "323350",
        "311840",
        "314130",
        "308700",
        "311060",
        "303360",
        "271780",
        "279060",
        "302920",
        "276240",
        "299480",
        "299670",
        "163430",
        "288490",
        "285770",
        "281310",
        "236030",
        "284420",
        "277880",
        "278990",
        "270020",
        "267060",
        "270660",
        "270210",
        "271850",
        "224880",
        "266170",
        "267810",
        "266870",
        "225860",
        "284610",
        "278380",
        "242350",
        "258250",
        "258540",
        "232830",
        "243870",
        "251280",
        "251960",
        "239890",
        "191600",
        "246250",
        "245450",
        "208850",
        "224020",
        "244880",
        "112190",
        "241510",
        "238500",
        "217910",
        "212310",
        "222160",
        "250030",
        "240340",
        "327610",
        "236340",
        "232530",
        "215570",
        "233990",
        "232680",
        "211050",
        "227420",
        "229500",
        "228180",
        "229000",
        "224760",
        "223220",
        "233250",
        "238170",
        "252370",
        "149300",
        "221800",
        "217880",
        "258050",
        "222670",
        "220110",
        "225220",
        "215050",
        "217950",
        "205290",
        "208890",
        "214610",
        "140610",
        "200580",
        "203400",
        "206950",
        "200350",
        "217320",
        "178600",
        "189330",
        "189540",
        "189350",
        "183350",
        "150440",
        "179720",
        "086080",
        "260870",
        "158300",
        "180060",
        "140290",
        "120780",
        "210120",
        "084440",
        "121060",
        "140660",
        "216280",
        "058970",
        "207490",
        "234070",
        "260970",
        "224810",
        "149010",
        "185190",
        "126340",
        "199290",
        "225850",
        "162120",
        "176750",
        "183410",
        "199150",
        "135160",
        "076340",
        "107640",
        "136660",
        "220250",
        "103660",
        "114920",
        "216400",
        "116100",
        "101360",
        "202960",
        "199800",
        "066830",
        "148780",
        "092590",
        "064850",
        "044990",
        "086460",
        "067370",
        "086220",
    ]
    # All_tickers = list(set(stock.get_market_ticker_list()) - set(konex))
    # All_tickers = ['005930', '005380']
    All_tickers = [
        "000020",
        "000040",
        "000050",
        "000060",
        "000070",
        "000080",
        "000100",
        "000120",
        "000140",
        "000150",
        "000180",
        "000220",
        "000230",
        "000240",
        "000250",
        "000270",
        "000300",
        "000320",
        "000370",
        "000390",
        "000400",
        "000430",
        "000440",
        "000480",
        "000490",
        "000500",
        "000520",
        "000540",
        "000590",
        "000640",
        "000650",
        "000660",
        "000670",
        "000680",
        "000700",
        "000720",
        "000760",
        "000810",
        "000850",
        "000860",
        "000880",
        "000890",
        "000910",
        "000950",
        "000970",
        "000990",
        "001000",
        "001020",
        "001040",
        "001060",
        "001070",
        "001080",
        "001120",
        "001130",
        "001140",
        "001200",
        "001210",
        "001230",
        "001250",
        "001260",
        "001270",
        "001290",
        "001340",
        "001360",
        "001380",
        "001390",
        "001420",
        "001430",
        "001440",
        "001450",
        "001460",
        "001470",
        "001500",
        "001510",
        "001520",
        "001530",
        "001540",
        "001550",
        "001560",
        "001570",
        "001620",
        "001630",
        "001680",
        "001720",
        "001740",
        "001750",
        "001770",
        "001780",
        "001790",
        "001800",
        "001810",
        "001820",
        "001840",
        "001880",
        "001940",
        "002020",
        "002030",
        "002070",
        "002100",
        "002140",
        "002150",
        "002170",
        "002200",
        "002210",
        "002220",
        "002230",
        "002240",
        "002270",
        "002290",
        "002310",
        "002320",
        "002350",
        "002360",
        "002380",
        "002390",
        "002410",
        "002450",
        "002460",
        "002600",
        "002620",
        "002630",
        "002680",
        "002690",
        "002700",
        "002710",
        "002720",
        "002760",
        "002780",
        "002790",
        "002800",
        "002810",
        "002820",
        "002840",
        "002870",
        "002880",
        "002900",
        "002920",
        "002960",
        "002990",
        "003000",
        "003010",
        "003030",
        "003060",
        "003070",
        "003080",
        "003090",
        "003100",
        "003120",
        "003160",
        "003200",
        "003220",
        "003230",
        "003240",
        "003300",
        "003310",
        "003350",
        "003380",
        "003410",
        "003460",
        "003470",
        "003480",
        "003490",
        "003520",
        "003530",
        "003540",
        "003550",
        "003560",
        "003570",
        "003580",
        "003610",
        "003650",
        "003670",
        "003680",
        "003690",
        "003720",
        "003780",
        "003800",
        "003830",
        "003850",
        "003920",
        "003960",
        "004000",
        "004020",
        "004060",
        "004080",
        "004090",
        "004100",
        "004140",
        "004150",
        "004170",
        "004250",
        "004270",
        "004310",
        "004360",
        "004370",
        "004380",
        "004410",
        "004430",
        "004440",
        "004450",
        "004490",
        "004540",
        "004560",
        "004590",
        "004650",
        "004690",
        "004700",
        "004710",
        "004720",
        "004770",
        "004780",
        "004800",
        "004830",
        "004840",
        "004870",
        "004890",
        "004910",
        "004920",
        "004960",
        "004970",
        "004980",
        "004990",
        "005010",
        "005030",
        "005070",
        "005090",
        "005110",
        "005160",
        "005180",
        "005190",
        "005250",
        "005290",
        "005300",
        "005320",
        "005360",
        "005380",
        "005390",
        "005420",
        "005430",
        "005440",
        "005490",
        "005500",
        "005610",
        "005670",
        "005680",
        "005690",
        "005710",
        "005720",
        "005740",
        "005750",
        "005800",
        "005810",
        "005820",
        "005830",
        "005850",
        "005860",
        "005870",
        "005880",
        "005930",
        "005940",
        "005950",
        "005960",
        "005990",
        "006040",
        "006050",
        "006060",
        "006090",
        "006110",
        "006120",
        "006140",
        "006200",
        "006220",
        "006260",
        "006280",
        "006340",
        "006360",
        "006370",
        "006380",
        "006390",
        "006400",
        "006490",
        "006570",
        "006580",
        "006620",
        "006650",
        "006660",
        "006730",
        "006740",
        "006800",
        "006840",
        "006880",
        "006890",
        "006910",
        "006920",
        "006980",
        "007070",
        "007110",
        "007120",
        "007160",
        "007210",
        "007280",
        "007310",
        "007330",
        "007340",
        "007370",
        "007390",
        "007460",
        "007530",
        "007540",
        "007570",
        "007590",
        "007610",
        "007660",
        "007680",
        "007690",
        "007700",
        "007720",
        "007770",
        "007810",
        "007820",
        "007860",
        "007980",
        "008040",
        "008060",
        "008110",
        "008250",
        "008260",
        "008290",
        "008350",
        "008370",
        "008420",
        "008470",
        "008490",
        "008500",
        "008560",
        "008600",
        "008700",
        "008730",
        "008770",
        "008830",
        "008870",
        "008930",
        "008970",
        "009070",
        "009140",
        "009150",
        "009160",
        "009180",
        "009190",
        "009200",
        "009240",
        "009270",
        "009290",
        "009300",
        "009310",
        "009320",
        "009410",
        "009420",
        "009440",
        "009450",
        "009460",
        "009470",
        "009520",
        "009540",
        "009580",
        "009620",
        "009680",
        "009770",
        "009780",
        "009810",
        "009830",
        "009900",
        "009970",
        "010040",
        "010050",
        "010060",
        "010100",
        "010120",
        "010130",
        "010140",
        "010170",
        "010240",
        "010280",
        "010400",
        "010420",
        "010470",
        "010600",
        "010620",
        "010640",
        "010660",
        "010690",
        "010770",
        "010780",
        "010820",
        "010950",
        "010960",
        "011000",
        "011040",
        "011070",
        "011080",
        "011090",
        "011150",
        "011170",
        "011200",
        "011210",
        "011230",
        "011280",
        "011300",
        "011320",
        "011330",
        "011370",
        "011390",
        "011420",
        "011500",
        "011560",
        "011700",
        "011760",
        "011780",
        "011790",
        "011810",
        "011930",
        "012030",
        "012160",
        "012200",
        "012280",
        "012320",
        "012330",
        "012340",
        "012450",
        "012510",
        "012600",
        "012610",
        "012620",
        "012630",
        "012690",
        "012700",
        "012750",
        "012790",
        "012800",
        "012860",
        "013000",
        "013030",
        "013120",
        "013310",
        "013360",
        "013520",
        "013570",
        "013580",
        "013700",
        "013720",
        "013810",
        "013870",
        "013890",
        "013990",
        "014130",
        "014160",
        "014190",
        "014200",
        "014280",
        "014440",
        "014470",
        "014530",
        "014570",
        "014580",
        "014620",
        "014680",
        "014710",
        "014790",
        "014820",
        "014830",
        "014910",
        "014940",
        "014970",
        "014990",
        "015020",
        "015230",
        "015260",
        "015350",
        "015360",
        "015540",
        "015590",
        "015710",
        "015750",
        "015760",
        "015860",
        "015890",
        "016090",
        "016100",
        "016250",
        "016360",
        "016380",
        "016450",
        "016580",
        "016590",
        "016600",
        "016610",
        "016710",
        "016740",
        "016790",
        "016800",
        "016880",
        "016920",
        "017000",
        "017040",
        "017180",
        "017250",
        "017370",
        "017390",
        "017480",
        "017510",
        "017550",
        "017650",
        "017670",
        "017800",
        "017810",
        "017890",
        "017900",
        "017940",
        "017960",
        "018000",
        "018120",
        "018250",
        "018260",
        "018290",
        "018310",
        "018470",
        "018500",
        "018620",
        "018670",
        "018680",
        "018700",
        "018880",
        "019010",
        "019170",
        "019180",
        "019210",
        "019440",
        "019490",
        "019540",
        "019550",
        "019570",
        "019590",
        "019660",
        "019680",
        "019770",
        "019990",
        "020000",
        "020120",
        "020150",
        "020180",
        "020400",
        "020710",
        "020760",
        "021040",
        "021050",
        "021080",
        "021240",
        "021320",
        "021650",
        "021880",
        "022100",
        "022220",
        "023000",
        "023150",
        "023160",
        "023350",
        "023410",
        "023440",
        "023450",
        "023460",
        "023530",
        "023590",
        "023600",
        "023760",
        "023770",
        "023790",
        "023800",
        "023810",
        "023890",
        "023900",
        "023910",
        "023960",
        "024060",
        "024070",
        "024090",
        "024110",
        "024120",
        "024720",
        "024740",
        "024800",
        "024810",
        "024840",
        "024850",
        "024880",
        "024890",
        "024900",
        "024910",
        "024940",
        "024950",
        "025000",
        "025320",
        "025440",
        "025530",
        "025540",
        "025550",
        "025560",
        "025620",
        "025750",
        "025770",
        "025820",
        "025860",
        "025870",
        "025880",
        "025890",
        "025900",
        "025950",
        "025980",
        "026040",
        "026150",
        "026890",
        "026910",
        "026940",
        "026960",
        "027040",
        "027050",
        "027360",
        "027410",
        "027580",
        "027710",
        "027740",
        "027830",
        "027970",
        "028050",
        "028080",
        "028100",
        "028150",
        "028260",
        "028300",
        "028670",
        "029460",
        "029480",
        "029530",
        "029780",
        "029960",
        "030000",
        "030190",
        "030200",
        "030210",
        "030350",
        "030520",
        "030530",
        "030610",
        "030720",
        "030790",
        "030960",
        "031310",
        "031330",
        "031390",
        "031430",
        "031440",
        "031510",
        "031820",
        "031860",
        "031980",
        "032080",
        "032190",
        "032280",
        "032300",
        "032350",
        "032500",
        "032540",
        "032560",
        "032580",
        "032620",
        "032640",
        "032680",
        "032750",
        "032800",
        "032820",
        "032830",
        "032850",
        "032860",
        "032940",
        "032960",
        "032980",
        "033050",
        "033100",
        "033130",
        "033160",
        "033170",
        "033180",
        "033200",
        "033230",
        "033240",
        "033250",
        "033270",
        "033290",
        "033310",
        "033320",
        "033340",
        "033500",
        "033530",
        "033540",
        "033560",
        "033640",
        "033660",
        "033780",
        "033830",
        "033920",
        "034020",
        "034120",
        "034220",
        "034230",
        "034300",
        "034310",
        "034590",
        "034730",
        "034810",
        "034830",
        "034940",
        "034950",
        "035000",
        "035080",
        "035150",
        "035200",
        "035250",
        "035420",
        "035460",
        "035510",
        "035600",
        "035610",
        "035620",
        "035720",
        "035760",
        "035810",
        "035890",
        "035900",
        "036000",
        "036010",
        "036030",
        "036090",
        "036120",
        "036170",
        "036190",
        "036200",
        "036420",
        "036460",
        "036480",
        "036490",
        "036530",
        "036540",
        "036560",
        "036570",
        "036580",
        "036620",
        "036630",
        "036640",
        "036670",
        "036690",
        "036710",
        "036800",
        "036810",
        "036830",
        "036890",
        "036930",
        "037030",
        "037070",
        "037230",
        "037270",
        "037330",
        "037350",
        "037370",
        "037400",
        "037440",
        "037460",
        "037560",
        "037710",
        "037760",
        "037950",
        "038010",
        "038060",
        "038070",
        "038110",
        "038290",
        "038340",
        "038390",
        "038460",
        "038500",
        "038530",
        "038540",
        "038620",
        "038680",
        "038870",
        "038880",
        "038950",
        "039010",
        "039020",
        "039030",
        "039130",
        "039200",
        "039240",
        "039290",
        "039310",
        "039340",
        "039420",
        "039440",
        "039490",
        "039560",
        "039570",
        "039610",
        "039740",
        "039830",
        "039840",
        "039860",
        "039980",
        "040160",
        "040300",
        "040350",
        "040420",
        "040610",
        "040910",
        "041020",
        "041140",
        "041190",
        "041440",
        "041460",
        "041510",
        "041520",
        "041590",
        "041650",
        "041830",
        "041910",
        "041920",
        "041930",
        "041960",
        "042000",
        "042040",
        "042110",
        "042370",
        "042420",
        "042500",
        "042510",
        "042520",
        "042600",
        "042660",
        "042670",
        "042700",
        "042940",
        "043090",
        "043150",
        "043200",
        "043220",
        "043260",
        "043290",
        "043340",
        "043360",
        "043370",
        "043610",
        "043650",
        "043710",
        "043910",
        "044060",
        "044180",
        "044340",
        "044380",
        "044450",
        "044480",
        "044490",
        "044780",
        "044820",
        "044960",
        "045060",
        "045100",
        "045300",
        "045340",
        "045390",
        "045510",
        "045520",
        "045660",
        "045890",
        "045970",
        "046070",
        "046110",
        "046120",
        "046140",
        "046210",
        "046310",
        "046390",
        "046440",
        "046890",
        "046940",
        "046970",
        "047040",
        "047050",
        "047080",
        "047310",
        "047400",
        "047560",
        "047770",
        "047810",
        "047820",
        "047920",
        "048260",
        "048410",
        "048430",
        "048470",
        "048530",
        "048550",
        "048770",
        "048830",
        "048870",
        "048910",
        "049070",
        "049080",
        "049120",
        "049430",
        "049470",
        "049480",
        "049520",
        "049550",
        "049630",
        "049720",
        "049770",
        "049800",
        "049830",
        "049950",
        "049960",
        "050090",
        "050110",
        "050760",
        "050860",
        "050890",
        "050960",
        "051160",
        "051360",
        "051370",
        "051380",
        "051390",
        "051490",
        "051500",
        "051600",
        "051630",
        "051780",
        "051900",
        "051910",
        "051980",
        "052020",
        "052220",
        "052260",
        "052300",
        "052330",
        "052400",
        "052420",
        "052460",
        "052600",
        "052670",
        "052690",
        "052710",
        "052790",
        "052860",
        "052900",
        "053030",
        "053050",
        "053060",
        "053080",
        "053110",
        "053160",
        "053210",
        "053260",
        "053270",
        "053280",
        "053290",
        "053300",
        "053350",
        "053450",
        "053580",
        "053590",
        "053610",
        "053620",
        "053690",
        "053700",
        "053800",
        "053950",
        "053980",
        "054040",
        "054050",
        "054090",
        "054180",
        "054210",
        "054300",
        "054410",
        "054450",
        "054540",
        "054620",
        "054630",
        "054670",
        "054780",
        "054800",
        "054920",
        "054930",
        "054940",
        "054950",
        "055490",
        "055550",
        "056080",
        "056090",
        "056190",
        "056360",
        "056700",
        "057030",
        "057050",
        "057540",
        "057680",
        "057880",
        "058110",
        "058400",
        "058420",
        "058430",
        "058470",
        "058610",
        "058630",
        "058650",
        "058730",
        "058820",
        "058850",
        "058860",
        "059090",
        "059100",
        "059120",
        "059210",
        "060150",
        "060230",
        "060240",
        "060250",
        "060260",
        "060280",
        "060310",
        "060370",
        "060380",
        "060480",
        "060540",
        "060560",
        "060570",
        "060590",
        "060720",
        "060850",
        "060900",
        "060980",
        "061040",
        "061250",
        "061970",
        "062860",
        "062970",
        "063080",
        "063160",
        "063170",
        "063440",
        "063570",
        "063760",
        "064090",
        "064240",
        "064260",
        "064290",
        "064350",
        "064480",
        "064510",
        "064550",
        "064760",
        "064800",
        "064820",
        "064850",
        "064960",
        "065060",
        "065130",
        "065150",
        "065170",
        "065350",
        "065370",
        "065440",
        "065450",
        "065500",
        "065510",
        "065530",
        "065560",
        "065570",
        "065650",
        "065660",
        "065680",
        "065690",
        "065710",
        "065770",
        "065950",
        "066130",
        "066310",
        "066360",
        "066410",
        "066430",
        "066570",
        "066590",
        "066620",
        "066670",
        "066700",
        "066900",
        "066910",
        "066970",
        "066980",
        "067000",
        "067010",
        "067080",
        "067160",
        "067170",
        "067280",
        "067290",
        "067310",
        "067390",
        "067570",
        "067630",
        "067730",
        "067770",
        "067830",
        "067900",
        "067920",
        "067990",
        "068050",
        "068240",
        "068270",
        "068290",
        "068330",
        "068400",
        "068760",
        "068790",
        "068930",
        "068940",
        "069080",
        "069110",
        "069140",
        "069260",
        "069410",
        "069460",
        "069510",
        "069620",
        "069640",
        "069730",
        "069920",
        "069960",
        "070590",
        "070960",
        "071050",
        "071090",
        "071200",
        "071280",
        "071320",
        "071460",
        "071670",
        "071840",
        "071850",
        "071950",
        "071970",
        "072020",
        "072130",
        "072470",
        "072520",
        "072710",
        "072770",
        "072870",
        "072950",
        "072990",
        "073010",
        "073110",
        "073190",
        "073240",
        "073490",
        "073540",
        "073560",
        "073570",
        "073640",
        "074430",
        "074600",
        "074610",
        "075130",
        "075180",
        "075580",
        "075970",
        "076080",
        "076610",
        "077360",
        "077500",
        "077970",
        "078000",
        "078020",
        "078070",
        "078130",
        "078140",
        "078150",
        "078160",
        "078340",
        "078350",
        "078520",
        "078590",
        "078600",
        "078650",
        "078860",
        "078890",
        "078930",
        "078940",
        "079000",
        "079160",
        "079170",
        "079370",
        "079430",
        "079550",
        "079650",
        "079810",
        "079940",
        "079950",
        "079960",
        "079970",
        "079980",
        "080000",
        "080010",
        "080160",
        "080220",
        "080420",
        "080470",
        "080520",
        "080530",
        "080580",
        "080720",
        "081000",
        "081150",
        "081580",
        "081660",
        "082210",
        "082270",
        "082640",
        "082660",
        "082740",
        "082800",
        "082850",
        "082920",
        "083310",
        "083420",
        "083450",
        "083500",
        "083550",
        "083640",
        "083650",
        "083660",
        "083790",
        "083930",
        "084010",
        "084110",
        "084180",
        "084370",
        "084650",
        "084670",
        "084680",
        "084690",
        "084730",
        "084850",
        "084870",
        "084990",
        "085310",
        "085370",
        "085620",
        "085660",
        "085670",
        "085810",
        "085910",
        "086040",
        "086060",
        "086280",
        "086390",
        "086450",
        "086520",
        "086670",
        "086790",
        "086820",
        "086890",
        "086900",
        "086960",
        "086980",
        "087010",
        "087260",
        "087600",
        "088130",
        "088290",
        "088350",
        "088390",
        "088790",
        "088800",
        "088910",
        "089010",
        "089030",
        "089140",
        "089150",
        "089230",
        "089470",
        "089530",
        "089590",
        "089600",
        "089790",
        "089850",
        "089890",
        "089970",
        "089980",
        "090080",
        "090150",
        "090350",
        "090360",
        "090370",
        "090410",
        "090430",
        "090460",
        "090470",
        "090710",
        "090740",
        "090850",
        "091090",
        "091120",
        "091340",
        "091440",
        "091580",
        "091590",
        "091700",
        "091810",
        "091970",
        "091990",
        "092040",
        "092070",
        "092130",
        "092190",
        "092200",
        "092220",
        "092230",
        "092300",
        "092440",
        "092460",
        "092600",
        "092730",
        "092780",
        "092870",
        "093050",
        "093190",
        "093230",
        "093240",
        "093320",
        "093370",
        "093380",
        "093520",
        "093640",
        "093920",
        "094170",
        "094280",
        "094360",
        "094480",
        "094820",
        "094840",
        "094850",
        "094860",
        "094940",
        "094970",
        "095190",
        "095270",
        "095340",
        "095500",
        "095570",
        "095610",
        "095660",
        "095700",
        "095720",
        "095910",
        "096040",
        "096240",
        "096350",
        "096530",
        "096610",
        "096630",
        "096640",
        "096690",
        "096760",
        "096770",
        "096870",
        "097230",
        "097520",
        "097780",
        "097800",
        "097870",
        "097950",
        "098120",
        "098460",
        "098660",
        "099190",
        "099220",
        "099320",
        "099410",
        "099440",
        "099520",
        "099750",
        "100030",
        "100090",
        "100120",
        "100130",
        "100220",
        "100250",
        "100590",
        "100660",
        "100700",
        "100790",
        "100840",
        "101000",
        "101060",
        "101140",
        "101160",
        "101170",
        "101240",
        "101330",
        "101360",
        "101390",
        "101400",
        "101490",
        "101530",
        "101670",
        "101680",
        "101730",
        "101930",
        "102120",
        "102260",
        "102280",
        "102460",
        "102710",
        "102940",
        "103140",
        "103230",
        "103590",
        "103840",
        "104040",
        "104200",
        "104460",
        "104480",
        "104540",
        "104620",
        "104700",
        "104830",
        "105330",
        "105550",
        "105560",
        "105630",
        "105740",
        "105840",
        "106190",
        "106240",
        "106520",
        "107590",
        "108230",
        "108320",
        "108380",
        "108490",
        "108670",
        "108860",
        "109080",
        "109610",
        "109740",
        "109820",
        "109860",
        "109960",
        "110020",
        "110790",
        "110990",
        "111110",
        "111710",
        "111770",
        "111870",
        "112040",
        "112610",
        "113810",
        "114090",
        "114120",
        "114450",
        "114630",
        "114810",
        "115160",
        "115180",
        "115310",
        "115390",
        "115440",
        "115450",
        "115480",
        "115500",
        "115570",
        "115610",
        "115960",
        "117580",
        "117670",
        "117730",
        "118000",
        "118990",
        "119500",
        "119610",
        "119650",
        "119830",
        "119850",
        "119860",
        "120030",
        "120110",
        "120240",
        "121440",
        "121600",
        "121800",
        "121850",
        "122310",
        "122350",
        "122450",
        "122640",
        "122690",
        "122870",
        "122900",
        "122990",
        "123010",
        "123040",
        "123330",
        "123410",
        "123420",
        "123570",
        "123690",
        "123700",
        "123750",
        "123840",
        "123860",
        "123890",
        "124500",
        "124560",
        "125210",
        "126340",
        "126560",
        "126600",
        "126640",
        "126700",
        "126870",
        "126880",
        "127120",
        "127160",
        "127710",
        "128540",
        "128660",
        "128820",
        "128940",
        "129260",
        "129890",
        "130500",
        "130580",
        "130660",
        "130740",
        "131030",
        "131090",
        "131100",
        "131180",
        "131220",
        "131290",
        "131370",
        "131390",
        "131400",
        "131760",
        "131970",
        "133750",
        "133820",
        "134060",
        "134380",
        "134580",
        "134790",
        "136480",
        "136490",
        "136510",
        "136540",
        "137400",
        "137940",
        "137950",
        "138040",
        "138070",
        "138080",
        "138250",
        "138490",
        "138580",
        "138610",
        "138690",
        "138930",
        "139050",
        "139130",
        "139480",
        "139670",
        "140070",
        "140410",
        "140520",
        "140670",
        "140860",
        "141000",
        "141070",
        "141080",
        "142210",
        "142280",
        "142760",
        "143160",
        "143210",
        "143240",
        "143540",
        "144510",
        "144620",
        "144960",
        "145020",
        "145210",
        "145720",
        "145990",
        "147760",
        "147830",
        "148140",
        "148150",
        "148250",
        "149950",
        "149980",
        "150840",
        "150900",
        "151860",
        "151910",
        "153460",
        "153490",
        "153710",
        "154030",
        "154040",
        "155650",
        "155660",
        "156100",
        "158430",
        "159580",
        "160550",
        "160980",
        "161000",
        "161390",
        "161570",
        "161580",
        "161890",
        "163560",
        "164060",
        "166090",
        "166480",
        "169330",
        "170030",
        "170790",
        "170900",
        "170920",
        "171010",
        "171090",
        "171120",
        "173130",
        "173940",
        "174880",
        "174900",
        "175140",
        "175250",
        "175330",
        "177350",
        "177830",
        "178320",
        "178780",
        "178920",
        "179290",
        "179900",
        "180640",
        "181340",
        "181710",
        "182360",
        "182400",
        "182690",
        "183190",
        "183300",
        "183490",
        "184230",
        "185490",
        "185750",
        "186230",
        "187220",
        "187270",
        "187420",
        "187790",
        "187870",
        "189300",
        "189690",
        "189860",
        "189980",
        "190510",
        "190650",
        "191410",
        "191420",
        "192080",
        "192250",
        "192390",
        "192400",
        "192410",
        "192440",
        "192650",
        "192820",
        "193250",
        "194370",
        "194480",
        "194700",
        "195500",
        "195870",
        "195990",
        "196170",
        "196300",
        "196490",
        "196700",
        "197140",
        "198080",
        "198440",
        "199820",
        "200130",
        "200230",
        "200470",
        "200670",
        "200710",
        "200780",
        "200880",
        "201490",
        "203450",
        "203650",
        "203690",
        "204020",
        "204270",
        "204320",
        "204620",
        "204630",
        "204840",
        "205100",
        "205470",
        "205500",
        "206400",
        "206560",
        "206640",
        "206650",
        "207760",
        "207940",
        "208140",
        "208340",
        "208350",
        "208370",
        "208640",
        "208710",
        "208860",
        "210540",
        "210980",
        "211270",
        "212560",
        "213090",
        "213420",
        "213500",
        "214150",
        "214180",
        "214260",
        "214270",
        "214310",
        "214320",
        "214330",
        "214370",
        "214390",
        "214420",
        "214430",
        "214450",
        "214610",
        "214680",
        "214870",
        "215000",
        "215090",
        "215100",
        "215200",
        "215360",
        "215380",
        "215480",
        "215790",
        "216050",
        "216080",
        "217190",
        "217270",
        "217330",
        "217480",
        "217500",
        "217600",
        "217620",
        "217730",
        "217820",
        "218150",
        "218410",
        "219130",
        "219420",
        "219550",
        "219750",
        "220100",
        "220180",
        "220260",
        "220630",
        "221610",
        "221840",
        "221980",
        "222040",
        "222080",
        "222110",
        "222420",
        "222800",
        "222810",
        "222980",
        "223250",
        "224060",
        "224110",
        "225190",
        "225220",
        "225330",
        "225430",
        "225530",
        "225570",
        "225590",
        "226320",
        "226330",
        "226340",
        "226360",
        "226400",
        "226440",
        "226950",
        "227100",
        "227610",
        "227840",
        "227950",
        "228340",
        "228670",
        "228760",
        "228850",
        "229000",
        "229640",
        "230240",
        "230360",
        "230980",
        "232140",
        "234080",
        "234100",
        "234300",
        "234340",
        "234690",
        "234920",
        "235980",
        "236200",
        "237690",
        "237750",
        "237820",
        "237880",
        "238090",
        "238120",
        "238200",
        "238490",
        "239340",
        "239610",
        "240810",
        "241520",
        "241560",
        "241590",
        "241690",
        "241710",
        "241770",
        "241790",
        "241820",
        "241840",
        "242040",
        "243070",
        "243840",
        "244460",
        "244920",
        "245620",
        "246690",
        "246710",
        "246720",
        "246960",
        "247540",
        "248170",
        "249420",
        "250000",
        "250060",
        "250930",
        "251270",
        "251370",
        "251630",
        "251970",
        "252500",
        "253450",
        "253590",
        "253840",
        "254120",
        "255220",
        "255440",
        "256150",
        "256630",
        "256840",
        "256940",
        "258610",
        "258790",
        "258830",
        "259630",
        "260660",
        "260930",
        "261200",
        "262260",
        "263020",
        "263050",
        "263600",
        "263690",
        "263700",
        "263720",
        "263750",
        "263770",
        "263800",
        "263810",
        "263860",
        "264450",
        "264660",
        "264850",
        "264900",
        "265520",
        "265560",
        "265740",
        "267250",
        "267260",
        "267270",
        "267290",
        "267320",
        "267790",
        "267850",
        "267980",
        "268280",
        "268600",
        "269620",
        "270520",
        "270870",
        "271560",
        "271980",
        "272110",
        "272210",
        "272290",
        "272450",
        "272550",
        "273060",
        "274090",
        "275630",
        "277070",
        "277410",
        "277880",
        "278280",
        "278650",
        "279600",
        "280360",
        "281740",
        "281820",
        "282330",
        "282690",
        "282880",
        "284620",
        "284740",
        "285130",
        "285490",
        "286750",
        "286940",
        "287410",
        "288330",
        "288620",
        "289010",
        "289080",
        "290120",
        "290270",
        "290380",
        "290510",
        "290520",
        "290550",
        "290650",
        "290660",
        "290670",
        "290690",
        "290720",
        "290740",
        "291210",
        "291230",
        "291650",
        "293480",
        "293490",
        "293580",
        "293780",
        "294090",
        "294140",
        "294630",
        "294870",
        "297090",
        "297570",
        "297890",
        "298000",
        "298020",
        "298040",
        "298050",
        "298060",
        "298380",
        "298540",
        "298690",
        "299030",
        "299170",
        "299660",
        "299900",
        "299910",
        "300080",
        "300120",
        "300720",
        "301300",
        "302430",
        "302550",
        "303030",
        "304100",
        "304840",
        "305090",
        "306040",
        "306200",
        "306620",
        "307180",
        "307280",
        "307750",
        "307870",
        "307930",
        "307950",
        "308100",
        "308170",
        "309930",
        "310200",
        "311390",
        "311690",
        "312610",
        "313760",
        "314130",
        "316140",
        "317120",
        "317240",
        "317330",
        "317400",
        "317530",
        "317690",
        "317770",
        "317830",
        "317850",
        "317870",
        "318000",
        "318010",
        "318020",
        "318410",
        "319660",
        "320000",
        "321550",
        "322000",
        "322180",
        "322510",
        "322780",
        "323230",
        "323280",
        "323990",
        "326030",
        "327260",
        "330350",
        "330860",
        "331920",
        "332370",
        "332570",
        "335810",
        "335890",
        "336260",
        "336370",
        "337930",
        "339770",
        "339950",
        "340570",
        "344820",
        "347000",
        "347140",
        "347740",
        "347770",
        "347860",
        "347890",
        "348150",
        "348210",
        "348350",
        "352770",
        "352820",
        "352940",
        "353200",
        "353810",
        "354200",
        "356860",
        "357550",
        "357780",
        "363280",
        "900070",
        "900110",
        "900120",
        "900140",
        "900250",
        "900260",
        "900270",
        "900280",
        "900300",
        "900310",
        "900340",
        "950110",
        "950130",
        "950140",
        "950170",
        "950180",
        "950190",
        "950200",
    ]
    a = time.time()
    result_ = sum(
        parmap.map(
            log_maker,
            All_tickers,
            start_date,
            end_date,
            pm_pbar=True,
            pm_processes=num_cores,
        ),
        [],
    )
    b = time.time()
    print(b - a)
    get_perfomance(result_)


"""
if __name__ == '__main__':
    num_cores = multiprocessing.cpu_count()
    konex = ['341310','179530','336040','331660','337840','093510','327970','329050','309900','317860','323350','311840','314130','308700','311060','303360','271780','279060','302920','276240','299480','299670','163430','288490','285770','281310','236030','284420','277880','278990','270020','267060','270660','270210','271850','224880','266170','267810','266870','225860','284610','278380','242350','258250','258540','232830','243870','251280','251960','239890','191600','246250','245450','208850','224020','244880','112190','241510','238500','217910','212310','222160','250030','240340','327610','236340','232530','215570','233990','232680','211050','227420','229500','228180','229000','224760','223220','233250','238170','252370','149300','221800','217880','258050','222670','220110','225220','215050','217950','205290','208890','214610','140610','200580','203400','206950','200350','217320','178600','189330','189540','189350','183350','150440','179720','086080','260870','158300','180060','140290','120780','210120','084440','121060','140660','216280','058970','207490','234070','260970','224810','149010','185190','126340','199290','225850','162120','176750','183410','199150','135160','076340','107640','136660','220250','103660','114920','216400','116100','101360','202960','199800','066830','148780','092590','064850','044990','086460','067370','086220']
    All_tickers = list(set(stock.get_market_ticker_list()) - set(konex))
    # All_tickers = ['005930']
    a = time.time()
    result_ =sum( parmap.map(log_maker, All_tickers, pm_pbar=True, pm_processes=num_cores), [])
    b = time.time()
    print(b-a)
    get_perfomance(result_)
"""

if __name__ == "__main__":
    mainfunc("20000101", "20200113")
    """
    mainfunc("20000101", "20000201")
    mainfunc("20000201", "20000301")
    mainfunc("20000301", "20000401")
    mainfunc("20000401", "20000501")
    mainfunc("20000501", "20000601")
    mainfunc("20000601", "20000701")
    mainfunc("20000701", "20000801")
    mainfunc("20000801", "20000901")
    mainfunc("20000901", "20001001")
    mainfunc("20001001", "20001101")
    mainfunc("20001101", "20001201")
    mainfunc("20001201", "20000101")
    #0년
    
    mainfunc("20010101", "20010201")
    mainfunc("20010201", "20010301")
    mainfunc("20010301", "20010401")
    mainfunc("20010401", "20010501")
    mainfunc("20010501", "20010601")
    mainfunc("20010601", "20010701")
    mainfunc("20010701", "20010801")
    mainfunc("20010801", "20010901")
    mainfunc("20010901", "20011001")
    mainfunc("20011001", "20011101")
    mainfunc("20011101", "20011201")
    mainfunc("20011201", "20020101")
    #1년

    mainfunc("20020101", "20020201")
    mainfunc("20020201", "20020301")
    mainfunc("20020301", "20020401")
    mainfunc("20020401", "20020501")
    mainfunc("20020501", "20020601")
    mainfunc("20020601", "20020701")
    mainfunc("20020701", "20020801")
    mainfunc("20020801", "20020901")
    mainfunc("20020901", "20021001")
    mainfunc("20021001", "20021101")
    mainfunc("20021101", "20021201")
    mainfunc("20021201", "20030101")
    #2년

    mainfunc("20030101", "20030201")
    mainfunc("20030201", "20030301")
    mainfunc("20030301", "20030401")
    mainfunc("20030401", "20030501")
    mainfunc("20030501", "20030601")
    mainfunc("20030601", "20030701")
    mainfunc("20030701", "20030801")
    mainfunc("20030801", "20030901")
    mainfunc("20030901", "20031001")
    mainfunc("20031001", "20031101")
    mainfunc("20031101", "20031201")
    mainfunc("20031201", "20040101")
    #3년

    mainfunc("20040101", "20040201")
    mainfunc("20040201", "20040301")
    mainfunc("20040301", "20040401")
    mainfunc("20040401", "20040501")
    mainfunc("20040501", "20040601")
    mainfunc("20040601", "20040701")
    mainfunc("20040701", "20040801")
    mainfunc("20040801", "20040901")
    mainfunc("20040901", "20041001")
    mainfunc("20041001", "20041101")
    mainfunc("20041101", "20041201")
    mainfunc("20041201", "20050101")
    #4년

    mainfunc("20050101", "20050201")
    mainfunc("20050201", "20050301")
    mainfunc("20050301", "20050401")
    mainfunc("20050401", "20050501")
    mainfunc("20050501", "20050601")
    mainfunc("20050601", "20050701")
    mainfunc("20050701", "20050801")
    mainfunc("20050801", "20050901")
    mainfunc("20050901", "20051001")
    mainfunc("20051001", "20051101")
    mainfunc("20051101", "20051201")
    mainfunc("20051201", "20060101")
    #5년

    mainfunc("20060101", "20060201")
    mainfunc("20060201", "20060301")
    mainfunc("20060301", "20060401")
    mainfunc("20060401", "20060501")
    mainfunc("20060501", "20060601")
    mainfunc("20060601", "20060701")
    mainfunc("20060701", "20060801")
    mainfunc("20060801", "20060901")
    mainfunc("20060901", "20061001")
    mainfunc("20061001", "20061101")
    mainfunc("20061101", "20061201")
    mainfunc("20061201", "20070101")
    #6년

    mainfunc("20070101", "20070201")
    mainfunc("20070201", "20070301")
    mainfunc("20070301", "20070401")
    mainfunc("20070401", "20070501")
    mainfunc("20070501", "20070601")
    mainfunc("20070601", "20070701")
    mainfunc("20070701", "20070801")
    mainfunc("20070801", "20070901")
    mainfunc("20070901", "20071001")
    mainfunc("20071001", "20071101")
    mainfunc("20071101", "20071201")
    mainfunc("20071201", "20080101")
    #7년

    mainfunc("20080101", "20080201")
    mainfunc("20080201", "20080301")
    mainfunc("20080301", "20080401")
    mainfunc("20080401", "20080501")
    mainfunc("20080501", "20080601")
    mainfunc("20080601", "20080701")
    mainfunc("20080701", "20080801")
    mainfunc("20080801", "20080901")
    mainfunc("20080901", "20081001")
    mainfunc("20081001", "20081101")
    mainfunc("20081101", "20081201")
    mainfunc("20081201", "20090101")
    #8년

    mainfunc("20090101", "20090201")
    mainfunc("20090201", "20090301")
    mainfunc("20090301", "20090401")
    mainfunc("20090401", "20090501")
    mainfunc("20090501", "20090601")
    mainfunc("20090601", "20090701")
    mainfunc("20090701", "20090801")
    mainfunc("20090801", "20090901")
    mainfunc("20090901", "20091001")
    
    mainfunc("20091001", "20091101")
    mainfunc("20091101", "20091201")
    mainfunc("20091201", "20100101")
    #9년

    mainfunc("20100101", "20100201")
    mainfunc("20100201", "20100301")
    mainfunc("20100301", "20100401")
    mainfunc("20100401", "20100501")
    mainfunc("20100501", "20100601")
    mainfunc("20100601", "20100701")
    mainfunc("20100701", "20100801")
    mainfunc("20100801", "20100901")
    mainfunc("20100901", "20101001")
    mainfunc("20101001", "20101101")
    mainfunc("20101101", "20101201")
    mainfunc("20101201", "20110101")
    #10년

    mainfunc("20110101", "20110201")
    mainfunc("20110201", "20110301")
    mainfunc("20110301", "20110401")
    mainfunc("20110401", "20110501")
    mainfunc("20110501", "20110601")
    mainfunc("20110601", "20110701")
    mainfunc("20110701", "20110801")
    mainfunc("20110801", "20110901")
    mainfunc("20110901", "20111001")
    mainfunc("20111001", "20111101")
    mainfunc("20111101", "20111201")
    mainfunc("20111201", "20120101")
    #11년

    mainfunc("20120101", "20120201")
    mainfunc("20120201", "20120301")
    
    mainfunc("20120301", "20120401")
    mainfunc("20120401", "20120501")
    mainfunc("20120501", "20120601")
    mainfunc("20120601", "20120701")
    mainfunc("20120701", "20120801")
    mainfunc("20120801", "20120901")
    mainfunc("20120901", "20121001")
    mainfunc("20121001", "20121101")
    mainfunc("20121101", "20121201")
    mainfunc("20121201", "20130101")
    #12년

    mainfunc("20130101", "20130201")
    mainfunc("20130201", "20130301")
    mainfunc("20130301", "20130401")
    mainfunc("20130401", "20130501")
    mainfunc("20130501", "20130601")
    mainfunc("20130601", "20130701")
    mainfunc("20130701", "20130801")
    mainfunc("20130801", "20130901")
    mainfunc("20130901", "20131001")
    mainfunc("20131001", "20131101")
    mainfunc("20131101", "20131201")
    mainfunc("20131201", "20140101")
    #13년

    mainfunc("20140101", "20140201")
    mainfunc("20140201", "20140301")
    mainfunc("20140301", "20140401")
    mainfunc("20140401", "20140501")
    mainfunc("20140501", "20140601")
    mainfunc("20140601", "20140701")
    mainfunc("20140701", "20140801")
    mainfunc("20140801", "20140901")
    mainfunc("20140901", "20141001")
    mainfunc("20141001", "20141101")
    mainfunc("20141101", "20141201")
    mainfunc("20141201", "20150101")
    #14년

    mainfunc("20150101", "20150201")
    mainfunc("20150201", "20150301")
    mainfunc("20150301", "20150401")
    mainfunc("20150401", "20150501")
    mainfunc("20150501", "20150601")
    mainfunc("20150601", "20150701")
    mainfunc("20150701", "20150801")
    mainfunc("20150801", "20150901")
    mainfunc("20150901", "20151001")
    mainfunc("20151001", "20151101")
    mainfunc("20151101", "20151201")
    mainfunc("20151201", "20160101")
    #15년

    mainfunc("20160101", "20160201")
    mainfunc("20160201", "20160301")
    mainfunc("20160301", "20160401")
    mainfunc("20160401", "20160501")
    mainfunc("20160501", "20160601")
    mainfunc("20160601", "20160701")
    mainfunc("20160701", "20160801")
    mainfunc("20160801", "20160901")
    mainfunc("20160901", "20161001")
    mainfunc("20161001", "20161101")
    mainfunc("20161101", "20161201")
    mainfunc("20161201", "20170101")
    #16년

    mainfunc("20170101", "20170201")
    mainfunc("20170201", "20170301")
    mainfunc("20170301", "20170401")
    mainfunc("20170401", "20170501")
    mainfunc("20170501", "20170601")
    mainfunc("20170601", "20170701")
    mainfunc("20170701", "20170801")
    mainfunc("20170801", "20170901")
    mainfunc("20170901", "20171001")
    mainfunc("20171001", "20171101")
    mainfunc("20171101", "20171201")
    mainfunc("20171201", "20180101")
    #17년

    mainfunc("20180101", "20180201")
    mainfunc("20180201", "20180301")
    mainfunc("20180301", "20180401")
    mainfunc("20180401", "20180501")
    mainfunc("20180501", "20180601")
    mainfunc("20180601", "20180701")
    mainfunc("20180701", "20180801")
    mainfunc("20180801", "20180901")
    mainfunc("20180901", "20181001")
    mainfunc("20181001", "20181101")
    mainfunc("20181101", "20181201")
    mainfunc("20181201", "20190101")
    #18년

    mainfunc("20190101", "20190201")
    mainfunc("20190201", "20190301")
    mainfunc("20190301", "20190401")
    mainfunc("20190401", "20190501")
    mainfunc("20190501", "20190601")
    mainfunc("20190601", "20190701")
    mainfunc("20190701", "20190801")
    mainfunc("20190801", "20190901")
    mainfunc("20190901", "20191001")
    mainfunc("20191001", "20191101")
    mainfunc("20191101", "20191201")
    mainfunc("20191201", "20200101")
    #19년

    mainfunc("20200101", "20200201")
    mainfunc("20200201", "20200301")
    mainfunc("20200301", "20200401")
    mainfunc("20200401", "20200501")
    mainfunc("20200501", "20200601")
    mainfunc("20200601", "20200701")
    mainfunc("20200701", "20200801")
    mainfunc("20200801", "20200901")
    mainfunc("20200901", "20201001")
    mainfunc("20201001", "20201101")
    mainfunc("20201101", "20201201")
    mainfunc("20201201", "20210101")
    #20년
    """
